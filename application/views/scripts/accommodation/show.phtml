<?php
    // <?php echo $this->gravatar($this->user['email'], array('imgSize' => 100, 'defaultImg' => 'identicon')); 
    if (strlen($this->acc->user->description)>0) {      
        //$sideBarHtml = '<ul class="photos">';
        //$sideBarHtml .= '<li>'.$this->gravatar($this->user['email'], array('imgSize' => 100, 'defaultImg' => 'identicon')) .'</li>';
        //$sideBarHtml .= '</ul>';
        $sideBarHtml = '<ul>';
        $sideBarHtml .=  '<li>'.$this->acc->user->description .'</li>';
        $sideBarHtml .= '</ul>';
        
    } else {
        $sideBarHtml = '<ul><li>'.$this->translate('No information avaliable').'</li></ul>';
    }
    $this->sideBarElement('About ' . $this->acc->user->nickname, $sideBarHtml);
?>

<?php
if (count($this->acc->photosurls) > 0) {
    echo '<script type="text/javascript">  Shadowbox.init();</script>';

    $thumbs = $this->acc->thumbsurls;

    $imgsHtml = '';
    $imgsHtml .= '<ul class="photos">';
    foreach ($this->acc->photosurls as $photo_id => $url) {
        $thumb = '<img src="' . $thumbs[$photo_id] . '" alt="thumbs" width="160px" heigth="118px" />';
        $imgsHtml .= '<li>';
        $imgsHtml .= '<a href="' . $url . '" rel="shadowbox[accommodation]"/>' . $thumb . '</a>';
        $imgsHtml .= '</li>';
    }
    $imgsHtml .= '</ul>';
    //  echo '<script type="text/javascript">  $("#pikame").PikaChoose(); </script>';

    $this->sideBarElement('Photos', $imgsHtml);
} else {
    $this->sideBarElement('Photos', '<ul><li>No photos avaliable</li></ul>');
}
?>   

<?php
    // load google maps api
    $this->headScript()->appendFile('http://maps.google.com/maps/api/js?sensor=false&region=PL', $type = 'text/javascript');
?>

<div class="grid_6 ">&nbsp;</div>
 <h1 class="title"><?php echo $this->acc->title; ?></h1>
<div id="acc-details" class="grid_6 alpha">    
    
    <div class="section grid_4 alpha">
        <h1 class="title">Description</h1>
    <p>
        <?php echo $this->acc->description; ?>
    </p>
    </div>
     <div class="section grid_2 omega" >
    <dl class="basic-info">
        <dt>Price (per month)</dt>
        <dd><?php echo $this->acc->price; ?> PLN</dd>
        <dt>Bond</dt>
        <dd><?php echo $this->acc->bond; ?> PLN</dd>
        
        <?php if (strlen($this->acc->price_info) > 0): ?>            
            <dt>Price info</dt>
            <dd><?php echo $this->acc->price_info; ?></dd>        
        <?php endif;?>
            
        <dt>Avaliable <?php echo $this->avaliable($this->acc)->inOrFrom(); ?>:</dt>
        <dd><?php echo $this->avaliable($this->acc)->time(); ?></dd>
    </dl>

      </div>

    <div class="section grid_6 alpha">
        <h1>Localization</h1> 
        <dl class="address">        
            <dt>Street:</dt>
            <dd><?php echo $this->acc->address->street; ?></dd>        
            <dt>City:</dt>
            <dd><?php echo $this->acc->city; ?></dd>
            <dt>State:</dt>
            <dd><?php echo $this->acc->state; ?></dd>
        </dl>
    </div>
       <div id="map" class="grid_6 " style="height: 300px">
   
     </div>
    <script type="text/javascript" src="<?php echo $this->baseUrl('/js/map.js');?>"></script>
    <div class="section grid_2 alpha ">
        <h1>Features</h1> 
        <?php
        $features = $this->acc->features;
        if (count($features) > 0) {
            echo '<ul class="feats-prefs">';
            foreach ($features as $f) {
                echo '<li>' . $f->getName() . '</li>';
            }
            echo '</ul>';
        }
        ?>
    </div>

    <div class="section grid_2 alpha  ">
        <h1>Preferences</h1> 
        <?php
        $prefs = $this->acc->preferences;
        if (count($prefs) > 0) {
            echo '<ul class="feats-prefs">';
            foreach ($prefs as $p) {
                echo '<li>' . $p->getName() . '</li>';
            }
            echo '</ul>';
        }
        ?>
    </div>

    <div class="section grid_2 omega">
        <h1>Roomates</h1> 
        <?php
        var_dump($this->acc->roomates->toArray());
        ?>
    </div>


    <div class="section grid_6 alpha">
        <h1>Contact</h1> 
        <a href="javascript:none;" id="ask-question">Ask a question</a>
        <div id="email-send-form">
            <?php echo $this->form; ?>        
        </div>
    </div>

</div>


<script type="text/javascript">      
    
    errors = <?php echo $this->errors; ?>;
     
    if (1 === errors) {
        $(window).scrollTop($('#send').position().top);
    }
    
    $(function() { 
        
        $('#ask-question').click(function() {
            $('#email-form').toggle('slow');
        });        
        
    });
    
</script>